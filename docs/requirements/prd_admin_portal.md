# PRD: 管理后台功能 (Admin Portal)

**版本**: v1.0  
**日期**: 2026-01-24  
**状态**: 已批准 (Approved)

---

## 1. 业务目标与愿景

### 核心痛点

管理员需要高效地审批企业注册、审核绩效数据、管理内容发布，并获得数据洞察以支持决策。

### 成功指标

- **审批效率**: 平均处理时间 < 24小时
- **数据覆盖**: 仪表盘统计覆盖100%已批准数据
- **管理便捷**: 单次操作完成率 > 90%

---

## 2. 用户故事

### US-AP-001: 仪表盘总览

> **作为** 系统管理员,  
> **我想要** 查看企业绩效数据的汇总统计和趋势图表,  
> **以便** 快速了解区域企业发展状况。

### US-AP-002: 企业审批

> **作为** 系统管理员,  
> **我想要** 审批或拒绝新注册的企业申请,  
> **以便** 控制平台访问权限。

### US-AP-003: 绩效审核

> **作为** 系统管理员,  
> **我想要** 审核企业提交的绩效数据,  
> **以便** 确保数据质量和真实性。

### US-AP-004: 企业查询

> **作为** 系统管理员,  
> **我想要** 通过Nice D&B API查询企业信息,  
> **以便** 验证企业真实性。

### US-AP-005: 数据导出

> **作为** 系统管理员,  
> **我想要** 将企业和绩效数据导出为Excel/CSV,  
> **以便** 进行离线分析和汇报。

---

## 3. 功能详情

### 3.1 仪表盘

**统计卡片**:

- 企业总数
- 总营收
- 总雇员数
- 知识产权数量

**趋势图表**:

- 营收年度趋势
- 雇员年度趋势
- 知识产权年度趋势
- 企业级趋势对比

**数据范围**: 仅统计已批准(approved)的绩效数据

**筛选条件**:

- 年份选择
- 季度选择

### 3.2 企业管理

#### 3.2.1 企业审批

**列表显示**:

- 企业名称
- 事业者登录号
- 代表人
- 注册日期
- 状态

**审批操作**:

- 批准 → 发送邮件通知
- 拒绝 + 原因 → 发送邮件通知

**搜索功能**:

- 企业名称
- 代表人
- 业务领域

#### 3.2.2 企业查询 (Nice D&B)

**查询条件**:

- 事业者登录号
- 代表人姓名
- 地区

**返回信息**:

- 企业概况
- 财务数据
- 信用评级

**缓存策略**: 24小时缓存

### 3.3 绩效审核

**列表筛选**:

- 企业选择
- 年份
- 季度
- 状态 (已提交/待修改/已批准)

**审核操作**:

- 批准 → 数据计入统计
- 要求修改 + 必填备注 → 发送邮件通知

**状态流转**:

```
submitted → approved (审批通过)
submitted → need_fix (要求修改)
need_fix → submitted (企业重新提交)
```

### 3.4 数据导出 ✅ 已实现

**支持格式**:

- Excel (.xlsx) - 带格式和自动列宽
- CSV (.csv) - UTF-8编码

**可导出数据**:
| 数据类型 | API端点 | 筛选参数 |
|----------|---------|----------|
| 绩效数据 | `/api/admin/performance/export` | status, memberId |
| 企业列表 | `/api/admin/members/export` | status, search |
| 项目数据 | `/api/admin/projects/export` | status, search |
| 申请数据 | `/api/admin/applications/export` | status, projectId |

### 3.5 UI/UX 体验

**布局结构**:

- 顶部栏: 管理员名称、登出
- 左侧边栏: 导航菜单
- 主内容区: 仪表盘/表格/表单

**图表库**: ECharts

- 响应式尺寸
- 统一配色

**表格功能**:

- 列排序
- 分页
- 行选择
- 批量操作

---

## 4. 验收标准

### 仪表盘

- [x] 统计卡片显示正确数据
- [x] 趋势图表正确渲染
- [x] 筛选条件正确过滤数据
- [x] 支持Excel导出

### 企业管理

- [x] 待审批企业列表正确显示
- [x] 批准后发送邮件通知
- [x] 拒绝时必须填写原因
- [x] Nice D&B查询功能正常

### 绩效审核

- [x] 已提交状态数据可审核
- [x] 批准后数据计入统计
- [x] 要求修改时必须填写备注
- [x] 企业收到修改通知邮件

### 数据导出

- [x] Excel格式导出正确
- [x] CSV格式导出正确
- [x] 文件名包含时间戳
- [x] 筛选条件应用于导出

### 性能要求

- [x] 仪表盘加载时间 < 3s
- [x] 列表查询响应 < 1s
- [x] 导出1000条记录 < 5s

---

## 5. 技术注解

### API 端点

| 方法 | 端点                                         | 描述       |
| ---- | -------------------------------------------- | ---------- |
| GET  | `/api/v1/admin/dashboard`                    | 仪表盘数据 |
| GET  | `/api/v1/admin/members`                      | 企业列表   |
| POST | `/api/v1/admin/members/{id}/approve`         | 批准企业   |
| POST | `/api/v1/admin/members/{id}/reject`          | 拒绝企业   |
| GET  | `/api/v1/admin/performance`                  | 绩效列表   |
| POST | `/api/v1/admin/performance/{id}/approve`     | 批准绩效   |
| POST | `/api/v1/admin/performance/{id}/request-fix` | 要求修改   |
| GET  | `/api/v1/admin/members/export`               | 导出企业   |
| GET  | `/api/v1/admin/performance/export`           | 导出绩效   |

### 依赖 Skill

- `dev-tdd_workflow` - 测试驱动开发
- `dev-frontend_patterns` - 前端规范
- `dev-libs_compatibility` - 第三方库兼容性 (ECharts, openpyxl)

### 外部服务

- **Nice D&B API**: 企业信息验证
- **Email Service**: 通知发送

---

_Generated by dev-prd skill_
