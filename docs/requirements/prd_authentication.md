# PRD: 认证与授权 (Authentication & Authorization)

**版本**: v1.0  
**日期**: 2026-01-24  
**状态**: 已批准 (Approved)

---

## 1. 业务目标与愿景

### 核心痛点

企业用户需要安全、便捷地访问江原创业门户，提交绩效数据和申请政府支持项目。系统需要区分企业用户和管理员角色，确保数据安全和权限隔离。

### 成功指标

- **安全性**: 零未授权访问事件
- **用户体验**: 注册流程完成率 > 80%
- **性能**: 登录响应时间 < 1s (P95)

---

## 2. 用户故事

### US-AUTH-001: 企业注册

> **作为** 企业代表,  
> **我想要** 通过多步骤流程注册企业账号,  
> **以便** 获得系统访问权限并提交绩效数据。

**术语检查**: ✅ 遵循 `dev-terminology`

- 使用 `Member` 而非 `User` 表示企业用户
- 使用 `MemberProfile` 表示企业详细信息

### US-AUTH-002: 用户登录

> **作为** 已注册的企业用户,  
> **我想要** 使用事业者登录号和密码登录,  
> **以便** 访问我的企业数据和功能。

### US-AUTH-003: 密码重置

> **作为** 忘记密码的企业用户,  
> **我想要** 通过邮箱重置密码,  
> **以便** 恢复账号访问权限。

### US-AUTH-004: 管理员登录

> **作为** 系统管理员,  
> **我想要** 通过独立入口登录管理后台,  
> **以便** 管理企业审批和内容发布。

---

## 3. 功能详情

### 3.1 企业注册流程

**步骤 1: 账号信息**

- 事业者登录号 (10位数字，唯一性验证)
- 企业名称
- 密码 (最少8位，包含字母、数字、特殊字符)

**步骤 2: 企业信息**

- 所在地区 (必填，下拉选择)
  - "江原特别自治道" / "강원특별자치도"
  - "江原以外" / "강원 이외"
- 法人号
- 地址
- 联系人信息

**步骤 3: 业务信息**

- 业务领域
- 营收规模
- 员工人数
- 成立日期

**步骤 4: 文件上传**

- 企业Logo (最大 2MB, jpg/png)
- 营业执照 (最大 10MB, pdf/jpg/png)

**步骤 5: 条款同意**

- 必须同意条款
- 可选同意条款

### 3.2 登录与会话管理

**认证机制**:

- JWT 令牌认证
- Access Token: 15分钟有效期
- Refresh Token: 7天有效期
- 30分钟无操作自动登出

**安全策略**:

- 5次登录失败后锁定账号
- 密码使用 PBKDF2/SHA256 哈希
- httpOnly Cookie 存储令牌

### 3.3 UI/UX 体验

**视觉风格**: 遵循 `dev-frontend_patterns`

- 深蓝色主题 (政府机构风格)
- 清晰的步骤指示器
- 表单验证即时反馈

**微互动**:

- 加载状态: 按钮 Spinner
- 成功状态: 绿色勾号 Toast
- 错误状态: 红色提示 + 详细信息

### 3.4 国际化 (i18n)

- **支持语言**: 韩语 (ko), 中文 (zh)
- **日期格式**: 按语言环境切换
- **错误消息**: 本地化显示

---

## 4. 验收标准

### 功能路径

- [x] 企业用户可完成5步注册流程
- [x] 注册后状态为"待审批"，需管理员批准
- [x] 已批准账号可正常登录
- [x] 登录失败显示明确错误信息
- [x] 密码重置邮件在30秒内发送

### 安全验证

- [x] 事业者登录号唯一性校验
- [x] 密码强度实时验证
- [x] JWT令牌过期后自动跳转登录页
- [x] 敏感操作需重新验证身份

### 性能要求

- [x] 登录API响应时间 < 1s (P95)
- [x] 注册表单渲染时间 < 2s
- [x] 支持50并发用户登录

### 边界处理

- [x] 网络断开时显示友好提示
- [x] 重复提交防护 (按钮防抖)
- [x] 会话过期优雅处理

### 术语/UI 校验

- [x] 命名符合 `dev-terminology`
- [x] 样式符合 `dev-frontend_patterns`

---

## 5. 技术注解

### API 端点

| 方法 | 端点                                  | 描述         |
| ---- | ------------------------------------- | ------------ |
| POST | `/api/v1/auth/register`               | 企业注册     |
| POST | `/api/v1/auth/login`                  | 登录         |
| POST | `/api/v1/auth/logout`                 | 登出         |
| POST | `/api/v1/auth/password-reset-request` | 请求密码重置 |
| POST | `/api/v1/auth/password-reset`         | 执行密码重置 |
| POST | `/api/v1/auth/refresh`                | 刷新令牌     |

### 依赖 Skill

- `dev-tdd_workflow` - 测试用例编写
- `dev-frontend_patterns` - 前端组件规范
- `dev-terminology` - 术语一致性

### 数据库表

- `users` - 管理员账号
- `members` - 企业账号
- `member_profiles` - 企业详细信息

---

_Generated by dev-prd skill_
